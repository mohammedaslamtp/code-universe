<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/codemirror@5.62.0/theme/ayu-mirage.css"
/>

<div *ngIf="liveLoading" class="relative inset-0 bg-black" style="width: 100%; height: 100%">
  <div
    class="absolute inset-0 bg-opacity-50 w-full h-full relative bg-neutral-400 flex justify-center align items-center"
  >
    <div class="flex flex-col gap-1 text-white">
      <i
        class="animate-spin fa-solid px-2 fa-spinner"
        style="font-size: 2em"
        title="Please wait"
      ></i>
      <p style="letter-spacing: 2px;">Joining</p>
    </div>
  </div>
</div>
<main class="h-screen grid" *ngIf="!liveLoading" style="grid-template-rows: 7% 93%">
  <!-- Navbar -->
  <nav class="bg-gray-800 w-full">
    <div class="px-3 sm:px-6 lg:px-8">
      <div class="relative flex h-16 items-center justify-between">
        <div
          class="flex flex-1 items-center items-stretch justify-start"
          (click)="closeDropDown()"
        >
          <div class="flex flex-shrink-0 items-center gap-x-3">
            <span class="relative flex h-3 w-3">
              <span
                class="animate-ping absolute inline-flex h-full w-full rounded-full bg-sky-400 opacity-75"
              ></span>
              <span
                class="relative inline-flex rounded-full h-3 w-3 bg-sky-500"
              ></span>
            </span>
            <a routerLink="/home">
              <h1 class="w-auto text-white text-2xl cursor-pointer">CODEBOX</h1>
            </a>
          </div>
        </div>
        <div
          class="absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0"
        >
          <!-- Profile dropdown -->
          <div class="relative ml-10">
            <div>
              <button
                type="button"
                (click)="toggleDropdownUsers()"
                class="flex rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800"
              >
                <img
                  class="h-8 w-8 rounded-full"
                  src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
                  alt=""
                />
              </button>
            </div>

            <div
              [ngClass]="
                isToggledUsers == true
                  ? [
                      'visible',
                      'transition-all',
                      'ease-in-out',
                      'duration-100',
                      'transform'
                    ]
                  : [
                      'invisible',
                      'transition-all',
                      'ease-in-out',
                      'duration-100',
                      'transform'
                    ]
              "
              (click)="closeDropDown()"
              class="absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none"
              role="menu"
              aria-orientation="vertical"
            >
              <a
                class="block px-4 py-2 text-sm text-gray-700"
                role="menuitem"
                tabindex="-1"
                id="user-menu-item-0"
                >Your Profile</a
              >
              <a
                class="block px-4 py-2 text-sm text-gray-700"
                role="menuitem"
                tabindex="-1"
                id="user-menu-item-1"
                >Settings</a
              >
              <a
                class="block px-4 py-2 text-sm text-gray-700"
                role="menuitem"
                tabindex="-1"
                id="user-menu-item-2"
                >Sign out</a
              >
            </div>
          </div>
          <button
            type="button"
            class="rounded-full ml-3 bg-gray-800 p-2 text-gray-400 hover:text-white"
          >
            <i class="fa-solid px-2 fa-question text-xl"></i>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <div class="flex">
    <section class="flex flex-col" style="width: 50%" id="data">
      <!-- <div class="w-full" style="height: 4.6em;"></div> -->
      <div
        style="
          height: 2em;
          flex: 1;
          background-color: darkslateblue;
          border-bottom: 5px solid;
        "
        id="html-header"
      >
        <p class="text-right p-2" style="background-color: rgb(203, 203, 203)">
          HTML
        </p>
      </div>
      <ngx-codemirror
        id="html"
        class="overflow-hidden"
        [(ngModel)]="htmlCode"
        [options]="htmlOptions"
        [autoFocus]="true"
        (ngModelChange)="htmlChange($event)"
      ></ngx-codemirror>
      <div
        style="flex: 1; background-color: gray; border-bottom: 5px solid"
        id="css-header"
      >
        <p class="text-right p-2" style="background-color: rgb(203, 203, 203)">
          CSS
        </p>
      </div>
      <ngx-codemirror
        id="css"
        class="overflow-hidden"
        [(ngModel)]="cssCode"
        [options]="cssOptions"
        (ngModelChange)="cssChange($event)"
      ></ngx-codemirror>
      <div
        style="flex: 1; height: 2em; background-color: darkolivegreen"
        id="js-header"
      >
        <p class="text-right p-2" style="background-color: rgb(203, 203, 203)">
          JS
        </p>
      </div>
      <ngx-codemirror
        id="js"
        class="overflow-hidden"
        [(ngModel)]="jsCode"
        [options]="jsOptions"
        (ngModelChange)="jsChange($event)"
      ></ngx-codemirror>
    </section>
    <div class="w-3 bg-gray-900" style="cursor: col-resize" id="resizer"></div>
    <div
      class="relative h-100"
      id="result-wrapper"
      style="margin-top: 4.3rem; flex-grow: 1"
    >
      <iframe
        #result
        class="h-full"
        style="width: 100%; height: 100%; margin: 0; padding: 0"
        src=""
      ></iframe>
    </div>
  </div>
</main>
